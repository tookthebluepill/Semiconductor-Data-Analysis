반도체 Wafer Map 불량 유형 분류 프로젝트
📝 프로젝트 개요
이 프로젝트는 캐글의 WM-811K Wafer Map 데이터셋을 사용하여 반도체 공정에서 발생하는 불량 유형을 자동으로 분류하는 딥러닝 모델을 개발합니다. 데이터 전처리부터 시작하여 점진적으로 모델의 성능을 개선하고, 최종적으로 하이퍼파라미터 튜닝을 통해 최적의 모델을 구축하는 전 과정을 다룹니다.

📂 프로젝트 구조
wafer-map-project/
├── .gitignore
├── README.md
├── requirements.txt
├── data/
│   └── LSWMD.pkl
├── images/
│   └── (결과 이미지 저장)
├── models/
│   └── (학습된 모델 저장)
└── src/
    ├── train.py        # 모델 학습 및 저장
    ├── analyze.py      # 저장된 모델 분석
    └── tune.py         # 하이퍼파라미터 튜닝
🚀 시작하기
1. 환경 설정
먼저 필요한 라이브러리를 설치합니다.

Bash

pip install -r requirements.txt
2. 데이터 준비
이 프로젝트는 용량이 큰 LSWMD.pkl 데이터 파일을 사용합니다. 아래 링크에서 직접 다운로드한 후, data/ 폴더 안에 위치시켜 주세요.

데이터 다운로드: Kaggle WM-811K Dataset

🛠️ 실행 순서
모델 학습: src/WM-811k_train.py를 실행하여 모델을 학습시키고 models/ 폴더에 저장합니다.

모델 분석: src/WM-811k_analyze.py를 실행하여 저장된 모델의 성능(혼동 행렬 등)을 분석합니다.

하이퍼파라미터 튜닝 (선택): src/WM-811k_tune.py를 실행하여 최적의 모델을 탐색합니다. (시간이 매우 오래 소요될 수 있습니다)

📊 모델 개선 과정 및 결과
모델의 성능을 점진적으로 개선하며 각 단계별 혼동 행렬(Confusion Matrix)을 통해 성능 변화를 분석했습니다.

1. Baseline 모델
기본적인 CNN 모델을 구축하여 성능의 기준점을 확인했습니다.

정확도: 약 87.21%

분석: 'Edge-Loc'과 'Loc' 유형 간의 혼동이 가장 큰 문제점으로 나타났습니다.

2. 데이터 증강 (Data Augmentation) 적용
과적합을 방지하고 모델의 일반화 성능을 높이기 위해 RandomFlip, RandomRotation 기법을 적용했습니다.

분석: 'Loc'과 'Edge-Loc'의 혼동은 일부 개선되었으나, 회전 증강으로 인해 'Edge-Loc'과 'Edge-Ring' 간의 새로운 혼동이 발생하는 부작용이 나타났습니다.

3. 모델 용량 증대
더 복잡한 패턴을 학습하기 위해 Conv2D 레이어를 추가하고 Dense 레이어의 뉴런 수를 늘렸습니다.

분석: 모델의 표현력이 증가하면서 데이터 증강으로 발생했던 'Edge-Loc'과 'Edge-Ring'의 혼동 문제가 크게 개선되었습니다. 전반적인 분류 정확도가 크게 향상되었습니다.

4. 하이퍼파라미터 튜닝
KerasTuner를 사용하여 최적의 학습률, 필터 수, 드롭아웃 비율 등을 탐색했습니다.

분석: 최종 모델은 각 클래스의 특징을 더 명확하게 구분하여 전반적으로 오분류가 감소했습니다. 안정적이고 높은 성능을 보이는 최종 모델을 확보했습니다.

💡 결론
본 프로젝트를 통해 데이터 전처리부터 시작하여, 데이터 증강, 모델 구조 변경, 하이퍼파라미터 튜닝 등 체계적인 과정을 통해 딥러닝 모델의 성능을 성공적으로 개선했습니다. 특히 혼동 행렬을 기반으로 모델의 약점을 진단하고, 이를 보완하는 전략을 반복적으로 적용하여 최종 목표를 달성했습니다.